<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>UserDataBase.md</title>
  <link rel="stylesheet" href="https://stackedit.io/style.css" />
</head>

<body class="stackedit">
  <div class="stackedit__html"><h1 id="handling-user-database-for-player-data"><strong>Handling User Database For Player Data</strong></h1>
<p>Call the DataManager Class from the UAFramework</p>
<pre class=" language-lua"><code class="prism  language-lua"><span class="token keyword">local</span> UAFramework <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span>to<span class="token punctuation">.</span>path<span class="token punctuation">)</span>
<span class="token keyword">local</span> DataManager <span class="token operator">=</span> UAFramework<span class="token punctuation">.</span>DataManager
</code></pre>
<p>Then we want to Call the “.createUserDB” constructor</p>
<pre class=" language-lua"><code class="prism  language-lua"><span class="token keyword">local</span> ManageProfiles <span class="token operator">=</span> DataManager<span class="token punctuation">.</span><span class="token function">createUserDB</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span>
</code></pre>
<h1 id="methods-when-managing-player-profile">Methods When Managing Player Profile</h1>
<p>To open a player profile, we use this:</p>
<pre class=" language-lua"><code class="prism  language-lua"><span class="token keyword">local</span> Profile <span class="token operator">=</span> ManageProfiles<span class="token punctuation">:</span><span class="token function">OpenProfile</span><span class="token punctuation">(</span>player<span class="token punctuation">)</span>
</code></pre>
<p>Use the “:Get” method to retrive the player data from the Database</p>
<pre class=" language-lua"><code class="prism  language-lua">Profile<span class="token punctuation">:</span><span class="token function">Get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">-- return data from the database</span>
</code></pre>
<p>Use the “:Update” Method to Update the Profile</p>
<pre class=" language-lua"><code class="prism  language-lua">Profile<span class="token punctuation">:</span><span class="token function">Update</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span>currentData<span class="token punctuation">)</span>
    <span class="token comment">-- add your little code here </span>

    <span class="token comment">-- Note: currentData is always in a table form</span>

    <span class="token keyword">return</span> currentData
<span class="token keyword">end</span><span class="token punctuation">)</span>
</code></pre>
<p>Now use “:ListenForError” to listen for errors projected from the profile</p>
<pre class=" language-lua"><code class="prism  language-lua">Profile<span class="token punctuation">:</span><span class="token function">ListenForError</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span>Type<span class="token punctuation">)</span>
    <span class="token keyword">if</span> Type <span class="token operator">==</span> <span class="token string">"Session"</span> <span class="token keyword">then</span>
        <span class="token comment">-- session locking code here</span>
    <span class="token keyword">elseif</span> Type <span class="token operator">==</span> <span class="token string">"DataNotUpdated"</span> <span class="token keyword">then</span>
        <span class="token comment">-- code here if player's data is not updated</span>
    <span class="token keyword">elseif</span> Type <span class="token operator">==</span> <span class="token string">"DataNotSaved"</span> <span class="token keyword">then</span>
        <span class="token comment">-- code here is player's profile is not closed</span>
    <span class="token keyword">elseif</span> Type <span class="token operator">==</span> <span class="token string">"DataNotLoaded"</span> <span class="token keyword">then</span>
        <span class="token comment">-- code here if player's data is not loaded</span>
    <span class="token keyword">end</span>
<span class="token keyword">end</span><span class="token punctuation">)</span>
</code></pre>
<p>Now use “:CloseProfile” to store and remove the profile</p>
<pre class=" language-lua"><code class="prism  language-lua">ManageProfiles<span class="token punctuation">:</span><span class="token function">CloseProfile</span><span class="token punctuation">(</span>player<span class="token punctuation">)</span>
</code></pre>
<p>Now use “:ResetProfile” to return the profile to its default state</p>
<pre class=" language-lua"><code class="prism  language-lua">ManageProfiles<span class="token punctuation">:</span><span class="token function">ResetProfile</span><span class="token punctuation">(</span>player<span class="token punctuation">)</span>
</code></pre>
<h3 id="we-are-done-with-the-player-profile">We are done with the player profile</h3>
<h1 id="managing-profile-changed-signal">Managing Profile Changed Signal</h1>
<pre class=" language-lua"><code class="prism  language-lua">ManageProfiles<span class="token punctuation">:</span><span class="token function">GetChangedSignal</span><span class="token punctuation">(</span>Type<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token function">Connect</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span>player<span class="token punctuation">,</span> data<span class="token punctuation">)</span>
    <span class="token comment">-- data from the data parameter will return if Type = "ProfileUpdated" else it would return nil</span>
<span class="token keyword">end</span><span class="token punctuation">)</span>
</code></pre>
<p>This detects if anything has changed with the data</p>
<h1 id="creating-templates">Creating Templates</h1>
<pre class=" language-lua"><code class="prism  language-lua">ManageProfiles<span class="token punctuation">.</span><span class="token function">CreateTemplate</span> <span class="token punctuation">{</span>
    Cash <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>
    Token <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>
    Tickets <span class="token operator">=</span> <span class="token number">0</span>
<span class="token punctuation">}</span>
</code></pre>
<p>This creates template that specific datastore.</p>
<h1 id="reading-templates">Reading Templates</h1>
<pre class=" language-lua"><code class="prism  language-lua">ManageProfiles<span class="token punctuation">:</span><span class="token function">ReturnExsistingTemplates</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
<p>This returns all the templates created</p>
<h1 id="reading-profiles">Reading Profiles</h1>
<pre class=" language-lua"><code class="prism  language-lua">ManageProfiles<span class="token punctuation">:</span><span class="token function">ReturnExsistingDatabaseProfiles</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
<p>This returns all the exsisting Profiles created</p>
</div>
</body>

</html>
